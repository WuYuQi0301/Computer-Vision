## 设计文档

算法原理

算法描述

- 直方图均衡
  1. 计算概率直方图
  2. 累计分布函数
  3. 灰度映射（同时吧灰度值相等或者近似合并）
- **颜色迁移**
  1. color constancy correction
  2. 伽马校正

1. convert from RGB to LMS space

   1. convert from RGB to XYZ 三色值，（取决于显示器荧光，此处用设备无关），将白色从色度图(CIE xy)映射到RGB空间，反之亦然。在色度图中，白色被定义为 x = X/（X+Y+Z）=0.333，y = y/(X+Y+Z)=0.333。为了将X=Y=Z=1映射到R=G=B=1，设标准转换矩阵
      $$
      \matrix[]
      $$

   2. 从XYZ转换到lab空间

   3. 综合以上两个变换矩阵得到一步变换

假设l、a、b分别是源图像lαβ通道原有的数据，L、A、B分别是变换后得到新的源图像lαβ通道的值，ml、ma、mb和ml’、ma’、mb’分别是源图像和着色图像的三个颜色通道的均值，nl、na、nb和nl’、na’、nb’表示它们的标准方差。

1. 将源图像原有的数据减掉源图像的均值
2. 得到的新数据按比例放缩，其放缩系数是两幅图像标准方差的比值
3. 得到的l’、a’、b’分别加上目标图像三个通道的均值，得到最终数据







## 测试文档

环境



直方图均衡

测试数据 ：彩色\*5，灰色*5

测试结果及分析



颜色迁移

测试数据：五对图像，一组颜色滤镜

测试结果及分析



origin rgb 127 148 175

log(LMS) 2.14929  2.16399 2.23018











